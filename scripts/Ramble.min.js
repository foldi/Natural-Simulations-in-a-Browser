/*! Ramble v1.0.0 - 2013-09-01 06:09:54 
Vince Allen |Brooklyn, NY | vince@vinceallen.com | @vinceallenvince | License: MIT */
!function(a,b){function c(a){this._gradients=[],this._colors=[],this.id=a||c._idCount,c._idCount++}function d(a,b){var c=b||{};if(!a||"object"!=typeof a)throw new Error("World: A valid DOM object is required for a new FroggerLane.");this.forceDirected=c.forceDirected,this.scrollSpeed=c.scrollSpeed||.5,this.position="fixed",this.adjusted=!1,this.acceleration=new Burner.Vector,this.velocity=new Burner.Vector,this._force=new Burner.Vector,this.friction=new Burner.Vector,this.mass=c.mass||3,this.minSpeed=c.minSpeed||0,this.maxSpeed=c.maxSpeed||15,Burner.World.call(this,a,c)}function e(a){var b=a||{};this.scrollVector=new Burner.Vector,Burner.Item.call(this,b)}function f(a,b){var c=b||{};if(!a)throw new Error("A DOM element is required for a new ScrollBlock.");this.el=a,this.heightBuffer=c.heightBuffer,this.height=c.height,this.el.style.height=this.height+"px"}function g(){var a,b;this.name="StatsDisplay",this._active=!0,this._fps=0,this._time=Date.now?Date.now():0,this._timeLastFrame=this._time,this._timeLastSecond=this._time,this._frameCount=0,this.el=document.createElement("div"),this.el.id="statsDisplay",this.el.className="statsDisplay",this.el.style.backgroundColor="black",this.el.style.color="white",this.el.style.fontFamily="Helvetica",this.el.style.padding="0.5em",this.el.style.opacity="0.5",this.el.style.position="fixed",this.el.style.top=0,this.el.style.left=0,this._totalElementsValue=null,this._fpsValue=null,a=document.createElement("span"),a.className="statsDisplayLabel",a.style.marginLeft="0.5em",b=document.createTextNode("total elements: "),a.appendChild(b),this.el.appendChild(a),this._totalElementsValue=document.createTextNode("0"),this.el.appendChild(this._totalElementsValue),a=document.createElement("span"),a.className="statsDisplayLabel",a.style.marginLeft="0.5em",b=document.createTextNode("fps: "),a.appendChild(b),this.el.appendChild(a),this._fpsValue=document.createTextNode("0"),this.el.appendChild(this._fpsValue),document.body.appendChild(this.el),this._update(this)}b.Ramble=a,c._idCount=0,c.prototype.name="ColorPalette",c.prototype.addColor=function(a){var b,d,e;for(d=c._getRandomNumber(a.min,a.max),e=c._createColorRange(a.startColor,a.endColor,255),b=0;d>b;b++)this._colors.push(e[c._getRandomNumber(0,e.length-1)]);return this},c.prototype.createGradient=function(a){if(this.startColor=a.startColor,this.endColor=a.endColor,this.totalColors=a.totalColors||255,!(this.totalColors>0))throw new Error("ColorPalette: total colors must be greater than zero.");this._gradients.push(c._createColorRange(this.startColor,this.endColor,this.totalColors))},c.prototype.getColor=function(){if(this._colors.length>0)return this._colors[c._getRandomNumber(0,this._colors.length-1)];throw new Error("ColorPalette.getColor: You must add colors via addColor() before using getColor().")},c.prototype.createSampleStrip=function(a){var b,c,d;for(b=0,c=this._colors.length;c>b;b++)d=document.createElement("div"),d.className="color-sample-strip",d.style.background="rgb("+this._colors[b].toString()+")",a.appendChild(d)},c._createColorRange=function(a,b,c){var d,e,f,g,h,i,j,k=[],l=a[0],m=a[1],n=a[2],o=b[0],p=b[1],q=b[2];for(e=o-l,f=p-m,g=q-n,d=0;c>d;d++)h=parseInt(e*d/c,10)+l,i=parseInt(f*d/c,10)+m,j=parseInt(g*d/c,10)+n,k.push([h,i,j]);return k},c._getRandomNumber=function(a,b,c){return c?Math.random()*(b-(a-1))+a:Math.floor(Math.random()*(b-(a-1)))+a};var h={};h.viewportDimensions=null,h.scrollBlock=null,h.scrollDirection=-1,h.scrollDistance=0,h.lastPageYOffset=0,h.totalColumns=0,h.cache={},h.MAX_LANES=1,h.INITIAL_Y_OFFSET=0,h.force=new Burner.Vector,h.init=function(b){var c,d,e,f=b||{};this.OBJ_PADDING=f.objPadding||20,this.OBJ_MIN_WIDTH=f.objMinWidth||60,this.OBJ_MAX_WIDTH=f.objMaxWidth||120,this.MIN_MASS=f.minMass||3,this.MAX_MASS=f.maxMass||1,this.MIN_SPEED=f.minSpeed||15,this.MAX_SPEED=f.maxSpeed||0,this.CONTENT_CONTAINER=f.CONTENT_CONTAINER||document.body,h.INITIAL_Y_OFFSET||(h.INITIAL_Y_OFFSET=f.initYOffset||this.OBJ_PADDING),this.forceDirected=void 0!==f.forceDirected?f.forceDirected:!0,this.mouseForce=!!f.mouseForce,this.viewportDimensions=i.getViewportSize(),this.totalColumns=this.getTotalColumns(),this.palette=f.palette||null,this.system=f.system;var g=(this.totalColumns-1)*this.OBJ_MAX_WIDTH+(this.totalColumns-1)*this.OBJ_PADDING,j=this.viewportDimensions.width/2-g/2;for(e=[],c=0,d=this.totalColumns;d>c;c++){var k=document.createElement("div");k.id="world"+c,this.CONTENT_CONTAINER.appendChild(k),e.push(new a.Lane(document.getElementById("world"+c),{forceDirected:this.forceDirected,mass:a.Utils.map(c,0,this.totalColumns,this.MAX_MASS,this.MIN_MASS),minSpeed:this.MIN_SPEED,maxSpeed:this.MAX_SPEED,width:this.OBJ_MAX_WIDTH,height:this.viewportDimensions.height,autoHeight:!0,location:new Burner.Vector((c+0)*(this.OBJ_MAX_WIDTH+this.OBJ_PADDING)+j,this.viewportDimensions.height/2+this.INITIAL_Y_OFFSET),scrollSpeed:0===c%2?this.MIN_SCROLL_SPEED:this.MAX_SCROLL_SPEED,paddingTop:0,boundToWindow:!1,position:"fixed",c:.1,index:c,totalColumns:this.totalColumns})),c||(e[e.length-1].afterResize=this.resize)}for(this.system.init(null,e,null,!0),c=0;c<Ramble.Driver.totalColumns;c++)Ramble.Driver.createRider(c);this.system.start(),this.defaultPosition=.5*this.viewportDimensions.height,this.scrollBlockHeight=this.mouseForce?0:3*this.viewportDimensions.height,this.lastScrollY=0,document.getElementById("scrollBlock").style.height=this.scrollBlockHeight+"px",window.scrollTo(0,this.defaultPosition),this.mouseForce?a.Utils._addEvent(document,"mousemove",this.onMouseForceMove):(a.Utils._addEvent(document,"mousedown",this.onMouseDown),a.Utils._addEvent(document,"mouseup",this.onMouseUp),a.Utils._addEvent(window,"mouseout",this.resetScrollBar),a.Utils._addEvent(document,"scroll",this.onScroll))},h.resetScrollBar=function(){h.isMouseDown=!1,window.scrollTo(0,h.defaultPosition),h.lastPageYOffset=null},h.onMouseDown=function(){h.isMouseDown=!0,a.Utils._addEvent(window,"mousemove",h.onMouseMove)},h.onMouseMove=function(){a.Utils._removeEvent(window,"mousemove",h.onMouseMove),window.scrollTo(0,h.defaultPosition),h.lastPageYOffset=null},h.onMouseUp=function(){h.isMouseDown=!1,h.resetScrollBar()},h.onScroll=function(){var b=document.getElementById("scrollBlock"),c=b.getBoundingClientRect();h.lastPageYOffset&&(h.scrollDirection=h.lastPageYOffset>window.pageYOffset?1:-1),h.force.y=-c.top>h.defaultPosition||-1===h.scrollDirection?a.Utils.map(-c.top,h.defaultPosition,h.scrollBlockHeight-h.viewportDimensions.height,0,-1):a.Utils.map(-c.top,0,h.defaultPosition,1,0),clearTimeout(h.scrollTimeout),h.scrollTimeout=setTimeout(function(){h.isMouseDown||(window.scrollTo(0,h.defaultPosition),h.lastPageYOffset=null)},100),h.lastPageYOffset=window.pageYOffset},h.onMouseForceMove=function(b){var c=b.clientY;h.force.y=c>h.viewportDimensions.height/2?a.Utils.map(c,h.viewportDimensions.height/2,h.viewportDimensions.height,0,-1):a.Utils.map(c,0,h.viewportDimensions.height/2,1,0)},h.getTotalColumns=function(){var a=Math.floor(this.viewportDimensions.width/(this.OBJ_MAX_WIDTH+this.OBJ_PADDING));return a},h.createRider=function(b,c){var d=c||{},e={},f=b%this.totalColumns;if(!d.contents){var g=document.createElement("div");g.className="innerContainer";var h=null!==this.palette?this.palette.getColor():[150,150,150];g.style.backgroundColor="rgb("+h[0]+", "+h[1]+", "+h[2]+")",g.style.borderRadius="10%",g.style.width=a.Utils.map(f,0,this.totalColumns-0,this.OBJ_MAX_WIDTH,this.OBJ_MIN_WIDTH)+"px";var i=a.Utils.map(f,0,this.totalColumns-0,this.OBJ_MAX_WIDTH,this.OBJ_MIN_WIDTH);g.style.height=i+"px",g.style.lineHeight=i+"px",g.style.fontSize=a.Utils.map(i,this.OBJ_MIN_WIDTH,this.OBJ_MAX_WIDTH,.5,1)+"em",g.style.marginTop="0px",g.style.borderWidth="2px",g.style.borderStyle="solid",g.style.borderColor="white",g.textContent=b,g.addEventListener("mouseup",function(a){alert(a.target.textContent)},!1),d.contents=g}e.contents=d.contents,e.index=b,e.name="Rider",e.zIndex=1,e.autoWidth=!0,e.width=this.OBJ_MAX_WIDTH,e.autoHeight=!0,e.height=this.OBJ_MAX_WIDTH,e.color="transparent",e.location="none",e.position="relative",e.opacity=1;var j=this.system.add("Rider",e,Burner.System._worlds.lookup["world"+f]);j.el.innerHTML="",j.el.appendChild(e.contents);var k=1;return(j.world.velocity.y<=0||Math.abs(j.world.velocity.y)<.1)&&(k=-1),-1===k&&j.world.el.firstChild?j.world.el.insertBefore(j.el,null):1===k&&j.world.el.firstChild&&j.world.el.insertBefore(j.el,j.world.el.firstChild),j},h.setTotalColumns=function(){this.totalColumns=Math.floor(this.viewportDimensions.width/(this.OBJ_MAX_WIDTH+this.OBJ_PADDING))},h.updateCache=function(a){this.cache[a.index]={height:a.height,firstChildHeight:a.firstChildHeight,contents:a.contents,scrollDirection:a.scrollDirection}},h.reflowObjs=function(){var b,c,d=Burner.System.getAllItemsByName("Rider");for(h.viewportDimensions=a.Utils.getViewportSize(),b=0,c=d.length;c>b;b++)Burner.System.destroyItem(d[b]);for(h.scrollDistance=0,h.setTotalColumns(),h.scrollDirection=-1,window.scrollTo(0,0),h.scrollBlock.height=h.viewportDimensions.height+10,b=0;b<h.totalColumns;b++)h.createRider(b,h.cache[b])},h.getMinMaxColumn=function(b){var c,d,e,f=Burner.System.getAllItemsByName("Rider"),g={lookup:{},list:[]};for(c=0,d=f.length;d>c;c++)e=f[c],g.lookup[e.myCol]||(g.lookup[e.myCol]=0),g.lookup[e.myCol]+=e.height+a.Driver.OBJ_PADDING+this.INITIAL_Y_OFFSET;for(c in g.lookup)g.lookup.hasOwnProperty(c)&&g.list.push(g.lookup[c]);return b?g.list.sort(function(a,b){return b-a}):g.list.sort(function(a,b){return a-b}),g.list[0]},Burner.System.extend(d,Burner.World),d.prototype.step=function(){this.forceDirected?(this.friction.x=this.velocity.x,this.friction.y=this.velocity.y,this.friction.mult(-1),this.friction.normalize(),this.friction.mult(this.c),this.applyForce(this.friction),this.applyForce(a.Driver.force),this.velocity.add(this.acceleration),this.velocity.limit(this.maxSpeed),Math.abs(this.velocity.y)>.1&&(this.marginTop+=this.velocity.y),this.marginTop>0&&(this.marginTop=0,this.velocity.mult(0)),this.acceleration.mult(0)):(this.velocity.y=a.Driver.force.y,Math.abs(a.Driver.force.y)>.1&&(this.marginTop+=a.Driver.force.y*this.maxSpeed),this.marginTop>0&&(this.marginTop=0)),this.adjusted=!1},d.prototype.applyForce=function(a){return a?(this._force.x=a.x,this._force.y=a.y,this._force.div(this.mass),this.acceleration.add(this._force),this.acceleration):void 0},d.prototype.step_=function(){this.adjusted=!1,this.marginTop-=a.Driver.force.y},Burner.System.extend(e,Burner.Item),e.prototype.init=function(){},e.prototype.step=function(){var a,b,c,d=(h.scrollDirection,h.totalColumns),e=h.cache,f=this.world,g=this.el.firstChild,i=this.el.getBoundingClientRect(),j=i.top,k=i.height;return this.scrollDirection=Math.abs(this.world.velocity.y)<.1?-1:this.world.velocity.y<=0?-1:1,!f.adjusted&&-1===this.scrollDirection&&j+k<h.viewportDimensions.height&&(c=Burner.System.getAllItemsByAttribute("index",this.index+d)[0],!c)?(0>j+k&&(Burner.System.systemError=!0),a=e[this.index+d],h.createRider(this.index+d,a),void 0):!f.adjusted&&1===this.scrollDirection&&j>0&&(b=Burner.System.getAllItemsByAttribute("index",this.index-d)[0],!b&&this.index>=d)?(j>h.viewportDimensions.height&&(Burner.System.systemError=!0),a=e[this.index-d],h.createRider(this.index-d,a),a&&(f.paddingTop-=a.firstChildHeight+h.OBJ_PADDING),f.adjusted=!0,void 0):!f.adjusted&&-1===this.scrollDirection&&0>j+k&&(c=Burner.System.getAllItemsByAttribute("index",this.index+d)[0])?(this.firstChildHeight=g.offsetHeight,h.updateCache(this),Burner.System.destroyItem(this),f.paddingTop+=this.firstChildHeight+h.OBJ_PADDING,f.adjusted=!0,void 0):!f.adjusted&&1===this.scrollDirection&&j>h.viewportDimensions.height&&(b=Burner.System.getAllItemsByAttribute("index",this.index-d)[0])?(h.updateCache(this),Burner.System.destroyItem(this),void 0):(this.lastLocY=j,void 0)},f.prototype.addHeight=function(a){var b=a||this.heightBuffer;this.height+=b,this.el.style.height=this.height+"px"},g.prototype.getFPS=function(){return this._fps},g.prototype._update=function(a){var b=Burner.System._records.list.length;a._time=Date.now?Date.now():0,a._frameCount++,a._time>a._timeLastSecond+1e3&&(a._fps=a._frameCount,a._timeLastSecond=a._time,a._frameCount=0,a._fpsValue.nodeValue=a._fps,a._totalElementsValue.nodeValue=b);var c=function(a){return function(){a._update(a)}}(this);this._active&&window.requestAnimFrame(c)},g.prototype.destroy=function(){this._active=!1,document.getElementById(this.el.id)&&document.body.removeChild(this.el)};var i={};i.getViewportSize=function(){var a={};return"undefined"!=typeof window.innerWidth?(a.width=window.innerWidth,a.height=window.innerHeight):"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth?(a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight):"undefined"!=typeof document.body?(a.width=document.body.clientWidth,a.height=document.body.clientHeight):(a.width=void 0,a.height=void 0),a},i._addEvent=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},i._removeEvent=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)},i.extend=function(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a},i.getRandomNumber=function(a,b,c){return c?Math.random()*(b-(a-1))+a:Math.floor(Math.random()*(b-(a-1)))+a},i.map=function(a,b,c,d,e){var f=(a-b)/(c-b);return f*(e-d)+d},a.ColorPalette=c,a.Driver=h,a.Lane=d,a.Rider=e,a.ScrollBlock=f,a.StatsDisplay=g,a.Utils=i}({},function(){return this}());