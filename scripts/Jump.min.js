/*! Jump v1.0.0 - 2013-09-06 09:09:47 
Vince Allen |Brooklyn, NY | vince@vinceallen.com | @vinceallenvince | License: MIT */
!function(a,b){function c(a){if(!Leap)throw new Error("Jumper requires Leapjs.");var b=a||{};this.interactionBoxCenter=b.center||[0,150,0],this.interactionBoxSize=b.size||[300,300,300],this.handID=null}function d(a,b){if(!a)throw new Error("StatusMessage requires a DOM element.");this.el=a,this.opacity=1,this.fade=!1,this.name="StatusMessage"}b.Jump=a,c.prototype.init=function(b){var c="undefined"!=typeof b?b:!0;this.interactionBox=new Leap.InteractionBox({center:this.interactionBoxCenter,size:this.interactionBoxSize}),this.controller=new Leap.Controller({enableGestures:!0});var d=this.controller;if(d.on("animationFrame",this.animFrame.bind(this)),c){var e=document.createElement("div");e.id="statusMessage",e.className="statusMessage",document.body.appendChild(e);var f=new a.StatusMessage(document.getElementById("statusMessage"));f.displayMessage("Please connect a Leap motion device.",!0),a.PubSub.subscribe("ready",f.displayMessage.bind(f,"ready")),a.PubSub.subscribe("disconnect",f.displayMessage.bind(f,"disconnected",!0)),a.PubSub.subscribe("blur",f.displayMessage.bind(f,"blur")),a.PubSub.subscribe("deviceConnected",f.displayMessage.bind(f,"deviceConnected")),a.PubSub.subscribe("deviceDisconnected",f.displayMessage.bind(f,"deviceDisconnected",!0)),a.PubSub.subscribe("active",f.displayMessage.bind(f,"active")),d.on("ready",function(){a.PubSub.publish("ready")}),d.on("connect",function(){a.PubSub.publish("connect")}),d.on("disconnect",function(){a.PubSub.publish("disconnect")}),d.on("focus",function(){a.PubSub.publish("focus")}),d.on("blur",function(){a.PubSub.publish("blur")}),d.on("deviceConnected",function(){a.PubSub.publish("deviceConnected")}),d.on("deviceDisconnected",function(){a.PubSub.publish("deviceDisconnected")})}d.connect()},c.prototype.animFrame=function(b){var c,d=b.hands;if(Burner&&(c=Burner.System.getAllItemsByAttribute("jumper")[0])){if(!d[0]||!d[0].fingers[0])return c.seekTarget=null,void 0;this.handID!==d[0].id&&(a.PubSub.publish("active"),this.handID=d[0].id);var e=d[0].fingers,f=e[0].stabilizedTipPosition,g=this.interactionBox.normalizePoint(f,!0),h=c.world.width,i=c.world.height,j=Burner.System.map(g[0],0,1,0,h),k=Burner.System.map(g[1],0,1,i,0),l={location:{x:j,y:k}};c.seekTarget=l}};var e={};e.subscribe=function(a,b){return this._callbacks||(this._callbacks={}),(this._callbacks[a]||(this._callbacks[a]=[])).push(b),this},e.publish=function(){var a,b,c,d,e=Array.prototype.slice.call(arguments,0),f=e.shift();if(!(b=this._callbacks))return this;if(!(a=this._callbacks[f]))return this;for(c=0,d=a.length;d>c;c+=1)a[c].apply(this,e);return this},d.prototype.displayMessage=function(a,b){this.el.innerHTML="Leap: <span class='emphasis'>"+a+"</span>",this.opacity=1,this.el.style.opacity=this.opacity,b||(this.fade=!0,this._update())},d.prototype._update=function(){this.opacity>0?this.opacity-=.005:(this.opacity=0,this.fade=!1),this.el.style.opacity=this.opacity,this.fade&&window.requestAnimFrame(this._update.bind(this))},a.Jumper=c,a.PubSub=e,a.StatusMessage=d}({},function(){return this}());